# lab1

### 2022.10.20

解决 map 输出临时文件，reduce 读取问题。用推荐的 json 存储

今天引入进程 pid 用作 server 端记录任务分配给哪个进程，所以任务状态映射的值变化为：-1 -> 未进行的任务，-2 -> 已完成的任务，大于 0 的值 -> 正在等待 worker 反馈的值 

### 2022.10.21

解决 import cycle 的问题。修改小 bug

### 2022.10.22 

解决中间文件的问题，通过 crash 之外的其他测试。明天需要解决，worker 超时回收任务再分配

加油最后的一个问题！

### 2022.10.23

今天实验室服务器崩了，后续得用 wsl 来写

### 2022.10.24

**PASSED ALL TESTS** lab 1 完结撒花！！！

### 2022.12.6

**PASSED ALL TESTS** 突然发现 lab1 存在几个 bug

+   临时文件写入磁盘应该由 master 完成不能给 worker 完成。思考如下过程：分配的 worker 速度慢了，master 认为它挂了于是再分配新的 worker 去工作，但是之前的 worker 并没有挂，这时候怎么保证两个 worker 不冲突。这时候就需要 commit 给 master 的时候由 master 将临时文件写入磁盘。 不然两个 worker 就冲突了。
+   由上述问题引出的问题，判断当前任务完成需要完成任务 worker 的 pid 与任务分配的 worker 的 pid 相同才能算任务完成。二者 pid 不同就说明，存在了上面的问题，只信当前任务分配的 worker 进程的结果，其他的都不信。其他的 worker 由于此时只有任务完成的临时文件，没有写入磁盘，所以直接丢弃这些文件。

# lab2A

### 2022.12.16

读了系统框架，这个lab大概的意思读明白了。 Raft 到底是什么有了新的认知。
剩余问题：Heartbeat，AppendEntry 在哪里怎么实现

### 2022.12.17

今天看懂了 Heartbeat 和 AppendEntry 的问题，问就是看 lab 的 hint。对 go 的并发还是了解太少导致有时候有思路怎么写，但是不知道用 go 怎么实现。
剩下的问题：状态机的控制，还有一些细节，明天需要仔细检查一下整个逻辑。best wishes！

### 2022.12.02

今天完成了第一个测试点，接下来是网络错误测试和多 Raft 测试，还有 bug 没过，明天看一看
剩下的问题：选举出错 or 其他问题的恢复